export const WEIGHTS={A:.25,B:.25,C:.15,D:.15,E:.1,F:.1};export const FACTOR_LABELS={A:'Evidence',B:'Volume/Setting',C:'Environment',D:'Relationships',E:'Engagement',F:'Fit/Coverage'};export function clamp01(x){return Math.max(0,Math.min(1,x))}export function computeScore(f){const a=clamp01(f.A??0),b=clamp01(f.B??0),c=clamp01(f.C??0),d=clamp01(f.D??0),e=clamp01(f.E??0),ff=clamp01(f.F??0);return Math.round(100*(WEIGHTS.A*a+WEIGHTS.B*b+WEIGHTS.C*c+WEIGHTS.D*d+WEIGHTS.E*e+WEIGHTS.F*ff))}export function daysAgo(iso){try{const d=new Date(iso);return Math.floor((Date.now()-d.getTime())/(1e3*60*60*24))}catch{return null}}export function freshnessBadge(lastUpdatedIso){if(!lastUpdatedIso)return{label:'unknown',tone:'bg-slate-200 text-slate-700'};const d=daysAgo(lastUpdatedIso);if(d==null||isNaN(d))return{label:'unknown',tone:'bg-slate-200 text-slate-700'};if(d<=30)return{label:`${d}d`,tone:'bg-emerald-100 text-emerald-700'};if(d<=120)return{label:`${d}d`,tone:'bg-amber-100 text-amber-700'};return{label:`${d}d`,tone:'bg-rose-100 text-rose-700'}}export function confidenceFromFreshness(f){const v=Object.values(f||{});if(!v.length)return{value:.7,label:'Medium'};const d=v.map(x=>daysAgo(x)??9999),cov=v.length,w30=d.filter(x=>x<=30).length,w180=d.filter(x=>x<=180).length,raw=.6*(w30/cov)+.35*(w180/cov)+.05,val=Math.max(0,Math.min(1,raw));return{value:val,label:val>=.85?'High':val>=.65?'Medium':'Low'}}
